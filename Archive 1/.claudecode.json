{
  "version": "3.0.1",
  "projectName": "KiiPS",
  "description": "Korea Investment Information Processing System - Enterprise Microservices Platform with ACE Framework",

  "aceFramework": {
    "enabled": true,
    "configPath": ".claude/ace-framework/ace-config.json",
    "layers": {
      "layer1": ".claude/ace-framework/layer1-aspirational.md",
      "layer3": ".claude/ace-framework/layer3-agent-model.json",
      "layer4": ".claude/ace-framework/layer4-executive.md",
      "layer45_domain_orchestration": ".claude/ace-framework/layer45-orchestration.md"
    },
    "agentHierarchy": {
      "primary": {
        "id": "primary-coordinator",
        "name": "Primary Coordinator",
        "model": "sonnet-4.5",
        "role": "strategic-coordinator",
        "configFile": ".claude/agents/primary-coordinator.md"
      },
      "managers": [
        {
          "id": "build-manager",
          "name": "Build Manager",
          "model": "sonnet-4.5",
          "role": "build-orchestrator",
          "domain": "Maven builds, multi-service builds, dependency resolution",
          "configFile": ".claude/agents/managers/build-manager.md"
        },
        {
          "id": "deployment-manager",
          "name": "Deployment Manager",
          "model": "sonnet-4.5",
          "role": "deployment-orchestrator",
          "domain": "Service deployment, health checks, rollback automation",
          "configFile": ".claude/agents/managers/deployment-manager.md"
        },
        {
          "id": "feature-manager",
          "name": "Feature Manager",
          "model": "sonnet-4.5",
          "role": "feature-orchestrator",
          "domain": "Feature development lifecycle, architect-developer-QA coordination",
          "configFile": ".claude/agents/managers/feature-manager.md"
        },
        {
          "id": "ui-manager",
          "name": "UI Manager",
          "model": "sonnet-4.5",
          "role": "ui-orchestrator",
          "domain": "UI/UX workflows, validation pipelines, responsive design",
          "configFile": ".claude/agents/managers/ui-manager.md"
        }
      ],
      "workers": [
        {
          "id": "kiips-developer",
          "name": "KiiPS Developer",
          "model": "sonnet-4.5",
          "role": "backend-developer",
          "configFile": ".claude/agents/kiips-developer.md"
        },
        {
          "id": "kiips-architect",
          "name": "KiiPS Architect",
          "model": "sonnet-4.5",
          "role": "system-architect",
          "configFile": ".claude/agents/kiips-architect.md"
        },
        {
          "id": "checklist-generator",
          "name": "Checklist Generator",
          "model": "sonnet-4.5",
          "role": "qa-specialist",
          "configFile": ".claude/agents/checklist-generator.md"
        }
      ]
    },
    "featureFlags": {
      "enableManagerAgents": true,
      "managerRoutingMode": "domain-first"
    }
  },

  "permissions": {
    "allowedTools": [
      "Read",
      "Write(src/**)",
      "Write(KiiPS-*/**/*.java)",
      "Write(KiiPS-*/**/*.jsp)",
      "Write(KiiPS-*/**/*.js)",
      "Edit",
      "Bash(mvn *)",
      "Bash(cd *)",
      "Bash(./start.sh)",
      "Bash(./stop.sh)",
      "Bash(tail *)",
      "Bash(grep *)",
      "Bash(curl *)",
      "Bash(lsof *)",
      "Bash(jq *)",
      "Bash(git *)",
      "Task"
    ],
    "deny": [
      "Write(.env*)",
      "Write(app-kiips.properties)",
      "Bash(rm -rf *)",
      "Bash(sudo *)",
      "Bash(DROP *)",
      "Bash(DELETE FROM *)"
    ]
  },

  "hooks": {
    "SessionStart": [
      {
        "type": "command",
        "command": "bash .claude/hooks/update-reminder.sh"
      }
    ],

    "UserPromptSubmit": [
      {
        "type": "command",
        "command": "node .claude/hooks/userPromptSubmit.js",
        "description": "ACE Layer 2/3 - Skill activation & capability matching"
      }
    ],

    "PreToolUse": [
      {
        "matcher": ".*",
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/ethicalValidator.js",
            "description": "ACE Layer 1 - Ethical validation for all tool use"
          }
        ]
      },
      {
        "matcher": "Task",
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/parallelCoordinator.js onTaskPreExecute",
            "description": "ACE Layer 5 - Parallel coordination for Task tool"
          }
        ]
      },
      {
        "matcher": "Bash(mvn *)",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Are you in KiiPS-HUB directory? Maven builds must start from KiiPS-HUB."
          }
        ]
      }
    ],

    "PostToolUse": [
      {
        "matcher": "(Write|Edit)\\(.*\\.(java|js|jsx|ts|tsx|scss|css)\\)",
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/autoFormatter.js",
            "description": "Boris Cherny - Auto-format code after Write/Edit"
          }
        ]
      },
      {
        "matcher": "Task",
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/hooks/parallelCoordinator.js onTaskPostExecute",
            "description": "ACE Layer 5 - Release locks and record metrics"
          }
        ]
      },
      {
        "matcher": "Write\\(.*pom\\.xml\\)",
        "hooks": [
          {
            "type": "command",
            "command": "echo '‚ö†Ô∏è  pom.xml changed - Rebuild required from KiiPS-HUB'"
          }
        ]
      },
      {
        "matcher": "Bash(./start.sh)",
        "hooks": [
          {
            "type": "command",
            "command": "echo '‚úÖ Service starting... Waiting 5 seconds for health check...'"
          },
          {
            "type": "command",
            "command": "sleep 5 && echo 'Checking health...'"
          }
        ]
      },
      {
        "matcher": "Bash(mvn clean package*)",
        "hooks": [
          {
            "type": "command",
            "command": "node .claude/coordination/checkpoint-manager.js create '{\"trigger\":\"after_successful_build\",\"description\":\"Auto checkpoint after Maven build\"}'",
            "description": "ACE - Auto checkpoint after successful build"
          },
          {
            "type": "command",
            "command": "echo '‚úÖ Build completed. Check target/ directory for artifacts.'"
          }
        ]
      }
    ],

    "Stop": [
      {
        "type": "command",
        "command": "node .claude/hooks/stopEvent.js",
        "description": "ACE Layer 6 - Self-check, feedback loop, and checkpoint"
      },
      {
        "type": "command",
        "command": "node .claude/coordination/feedback-loop.js generateSummary",
        "description": "ACE - Generate session telemetry summary"
      },
      {
        "type": "command",
        "command": "echo 'üìù Session ending. Remember to commit any changes and update dev docs if needed.'"
      }
    ],

    "PreCompact": [
      {
        "matcher": "auto",
        "hooks": [
          {
            "type": "command",
            "command": "bash .claude/hooks/pre-compact-save.sh",
            "description": "Auto-save Dev Docs before compact"
          }
        ]
      }
    ]
  },

  "skillActivation": {
    "rulesFile": "skill-rules.json",
    "autoActivate": true,
    "priority": ["critical", "high", "normal"],
    "enforcement": {
      "require": "block-until-acknowledged",
      "suggest": "show-notification",
      "block": "prevent-action"
    }
  },

  "agentCoordination": {
    "enabled": true,
    "primaryAgent": "primary-coordinator",
    "secondaryAgents": ["kiips-developer", "kiips-architect", "checklist-generator"],
    "lockManager": ".claude/coordination/file-lock-manager.js",
    "taskAllocator": ".claude/coordination/task-allocator.js",
    "checkpointManager": ".claude/coordination/checkpoint-manager.js",
    "feedbackLoop": ".claude/coordination/feedback-loop.js"
  },

  "devDocs": {
    "enabled": true,
    "location": "dev/active/",
    "templates": {
      "plan": "dev/templates/plan-template.md",
      "context": "dev/templates/context-template.md",
      "tasks": "dev/templates/tasks-template.md"
    }
  },

  "environment": {
    "local": {
      "apiGatewayPort": 8088,
      "defaultProfile": "local"
    },
    "staging": {
      "apiGatewayPort": 8088,
      "defaultProfile": "stg"
    },
    "production": {
      "apiGatewayPort": 8088,
      "defaultProfile": "kiips"
    }
  },

  "metadata": {
    "created": "2025-12-28",
    "lastUpdated": "2026-01-04",
    "version": "3.0.1",
    "maintainer": "KiiPS Development Team",
    "aceFrameworkVersion": "3.0.1-KiiPS"
  }
}
